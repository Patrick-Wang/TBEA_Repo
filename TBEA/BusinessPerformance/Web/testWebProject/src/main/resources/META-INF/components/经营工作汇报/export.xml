<components>
 <controller id="owrJydwztqkClr">
  <context key="data" value="${wrs.jydwztzb[compId][cal.date]}" export="false"/>
  <list id="ids">
   <item from="0" to="${data.size - 1}"/>
  </list>
  <table id="tbData" rowIds="ids" table="${data}"/>
  <formatter id="fmtData">
   <PercentFormatter reservedCount="1">
    <DefaultMatcher cols="3,5,8,10,12,14"/>
   </PercentFormatter>
   <NumberFormatter reservedCount="0"/>
  </formatter>
  <formatterServer id="fmtServ" table="${tbData.matrixNoIds}">
   <formatter ref="fmtData"/>
  </formatterServer>
  <context key="jydwztqk" value="${fmtServ.result}"/>
 </controller>
 <controller id="owrLrsrzbClr">
  <context key="data" value="${wrs.lrsrzb[compId][cal.date]}" export="false"/>
  <context key="totalLr" value="${math.sum[data.col[11].subList[0][6]]}"/>
  <context key="totalXs" value="${math.sum[data.col[11].subList[6][11]]}"/>
  <list id="ids">
   <item from="0" to="${data.size - 1 + 5}"/>
  </list>
  <list id="zb" type="double">
   <item>1</item>
   <item>${var ret = math.div[data[1][11]][data[0][11]]; ret &gt;= 0 ? ret
				: null}</item>
   <item>${var ret = math.div[data[2][11]][data[0][11]]; ret &gt;= 0 ? ret
				: null}</item>
   <item>${var ret = math.div[data[3][11]][data[0][11]]; ret &gt;= 0 ? ret
				: null}</item>
   <item>${var ret = math.div[data[4][11]][data[0][11]]; ret &gt;= 0 ? ret
				: null}</item>
   <item>${var ret = math.div[data[5][11]][data[0][11]]; ret &gt;= 0 ? ret
				: null}</item>
   <item>1</item>
   <item>${var ret = math.div[data[7][11]][data[6][11]]; ret &gt;= 0 ? ret
				: null}</item>
   <item>${var ret = math.div[data[8][11]][data[6][11]]; ret &gt;= 0 ? ret
				: null}</item>
   <item>${var ret = math.div[data[9][11]][data[6][11]]; ret &gt;= 0 ? ret
				: null}</item>
   <item>${var ret = math.div[data[10][11]][data[6][11]]; ret &gt;= 0 ? ret
				: null}</item>
   <item repeat="5" isNull="true"/>
  </list>
  <table id="tbData" rowIds="ids">
   <list sql="data" value="0"/>
   <list sql="data" value="1"/>
   <list sql="data" value="2"/>
   <list sql="data" value="3"/>
   <list sql="data" value="4"/>
   <list sql="data" value="5"/>
   <list sql="data" value="11"/>
   <list sql="data" value="12"/>
   <list sql="data" value="13"/>
   <list sql="data" value="14"/>
   <col list="zb"/>
   <divRow toRow="11">
    <excludeCol>3,5,7,9,10</excludeCol>
    <subRow>0</subRow>
    <baseRow>6</baseRow>
   </divRow>
   <divRow toRow="12">
    <excludeCol>3,5,7,9,10</excludeCol>
    <subRow>1</subRow>
    <baseRow>7</baseRow>
   </divRow>
   <divRow toRow="13">
    <excludeCol>3,5,7,9,10</excludeCol>
    <subRow>2</subRow>
    <baseRow>8</baseRow>
   </divRow>
   <divRow toRow="14">
    <excludeCol>3,5,7,9,10</excludeCol>
    <subRow>3</subRow>
    <baseRow>9</baseRow>
   </divRow>
   <divRow toRow="15">
    <excludeCol>3,5,7,9,10</excludeCol>
    <subRow>5</subRow>
    <baseRow>10</baseRow>
   </divRow>
   <divCol toCol="3" sub="2" base="1"/>
   <growthRates toCol="5" sj="2" tq="4"/>
   <divCol toCol="7" sub="6" base="0"/>
   <growthRates toCol="9" sj="7" tq="9"/>
  </table>
  <formatter id="fmtData">
   <PercentFormatter reservedCount="1">
    <DefaultMatcher cols="3,5,7,9,10"/>
   </PercentFormatter>
   <PercentFormatter reservedCount="1">
    <DefaultMatcher rows="11,12,13,14,15"/>
   </PercentFormatter>
   <NumberFormatter reservedCount="0"/>
  </formatter>
  <formatterServer id="fmtServ" table="${tbData.matrixNoIds}">
   <formatter ref="fmtData"/>
  </formatterServer>
  <context key="lrsrzb" value="${fmtServ.result}"/>
 </controller>
 <controller id="owrZbbhqsClr">
  <context key="calStart" value="${cal.lastYear}"/>
  <context key="comps" value="${orgs.BMDBOrganization.companiesByIds[compId.packAsList]}"/>
  <list id="zbs" type="int">1,
195,
196,
197,
198,
199,
6,
7,
12,
16, 
253</list>
  <loop from="0" to="12">
   <list id="dataTmp" type="string" clear="true">
    <item>${calStart.year &lt; cal.year ? '上年度' : '本年度'}</item>
    <item>${calStart.month + '月'}</item>
    <item concat="${accFactory.sjAcc.compute[0][calStart.date][calStart.date][zbs][comps]}"/>
   </list>
   <list id="data" type="object">
    <item>${dataTmp}</item>
   </list>
   <context key="calStart" value="${calStart.nextMonth}"/>
  </loop>
  <list id="ids">
   <item from="0" to="${data.size - 1 + 5}"/>
  </list>
  <table id="tbData" rowIds="ids">
  	<col list="${data[0]}"></col>
  	<col list="${data[1]}"></col>
  	<col list="${data[2]}"></col>
  	<col list="${data[3]}"></col>
  	<col list="${data[4]}"></col>
  	<col list="${data[5]}"></col>
  	<col list="${data[6]}"></col>
  	<col list="${data[7]}"></col>
  	<col list="${data[8]}"></col>
  	<col list="${data[9]}"></col>
  	<col list="${data[10]}"></col>
  	<col list="${data[11]}"></col>
  	<col list="${data[12]}"></col>
   <divRow toRow="13">
    <subRow>2</subRow>
    <baseRow>8</baseRow>
   </divRow>
   <divRow toRow="14">
    <subRow>3</subRow>
    <baseRow>9</baseRow>
   </divRow>
   <divRow toRow="15">
    <subRow>4</subRow>
    <baseRow>10</baseRow>
   </divRow>
   <divRow toRow="16">
    <subRow>5</subRow>
    <baseRow>11</baseRow>
   </divRow>
   <divRow toRow="17">
    <subRow>7</subRow>
    <baseRow>12</baseRow>
   </divRow>
  </table>
  <formatter id="fmtData">
  	<EmptyFormatter> 
  		<DefaultMatcher rows="0,1"/>
  	</EmptyFormatter>
   <PercentFormatter reservedCount="1">
    <DefaultMatcher rows="13,14,15,16,17"/>
   </PercentFormatter>
   <NumberFormatter reservedCount="0"/>
  </formatter>
  <formatterServer id="fmtServ" table="${tbData.matrixNoIds}">
   <formatter ref="fmtData"/>
  </formatterServer>
  <context key="zbbhqs" value="${fmtServ.result}"/>
 </controller>
 <controller id="operWorkReportXlClr">
  <context key="cal" value="${request.date.asCalendar}"/>
  <context key="compId" value="${request.compId.asInt}"/>
  <context key="dwmc" value="${request.dwmc.asString}"/>
  <callcontroller id="owrJydwztqkClr"/>
  <callcontroller id="owrLrsrzbClr"/>
  <callcontroller id="owrZbbhqsClr"/>
  <WordTemplate id="word" src="${TEMPLATE}jygzhb_xl_template.docx">
	<merge ref="zbbhqs" x="${12 - cal.month + 1}" y="0" width="${cal.month}" height="1"></merge>
  	<merge ref="zbbhqs" x="0" y="0" width="${12 - cal.month + 1}" height="1"></merge>
  </WordTemplate>
  <response type="word" name="${dwmc}${cal.year}年${cal.month}月经营工作分析材料.docx" ref="word"/>
 </controller>
</components>
