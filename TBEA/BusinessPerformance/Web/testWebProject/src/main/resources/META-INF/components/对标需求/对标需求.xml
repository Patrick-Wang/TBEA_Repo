<components>
 <service id="servDbxq" transaction="transactionManager">
  <sql id="zbs">select * from identifier_dbxq_zb</sql>
  <list id="ids" sql="zbs" value="0" type="int"/>
  <sql id="dbxqs" order="ids" by="zbid" colcount="2">select zbid, value from dbxq
where
nf = ${cal.year} and 
yf = ${cal.month} and
dwid = ${compId}</sql>
  <list id="category" type="string">盈利能力状况,
盈利能力状况,
盈利能力状况,
盈利能力状况,
盈利能力状况,
盈利能力状况,
资产质量状况,
资产质量状况,
资产质量状况,
资产质量状况,
资产质量状况,
债务风险状况,
债务风险状况,
债务风险状况,
债务风险状况,
债务风险状况,
债务风险状况,
经营增长状况,
经营增长状况,
经营增长状况,
经营增长状况,
经营增长状况,
补充资料,
补充资料,
补充资料,
补充资料,
补充资料,
补充资料



</list>
  <table id="result" rowIds="zbs" export="true">
   <col list="category"/>
   <list id="zbmc" type="string" sql="zbs" value="1"/>
   <list id="zbValue" type="double" sql="dbxqs" value="1"/>
  </table>
 </service>
 <controller id="servFmtterDbxq">
  <formatter id="fmtData" export="true">
   <EmptyFormatter>
    <DefaultMatcher cols="0,1"/>
   </EmptyFormatter>
   <NumberFormatter reservedCount="0">
    <DefaultMatcher cols="2" rows="6,7,8,9,22"/>
   </NumberFormatter>
   <PercentFormatter reservedCount="1"/>
  </formatter>
 </controller>
 <controller id="dbxqUpdate">
  <context key="cal" value="${request.date.asCalendar}"/>
  <context key="compId" value="${orgs.BMDBOrganization.ids[request.item.asInt]}"/>
  <callservice id="servDbxq"/>
  <callcontroller id="servFmtterDbxq"/>
  <formatterServer id="fmtServ" table="${result.matrixNoIds}">
   <formatter ref="fmtData"/>
  </formatterServer>
  <response type="json">
   <header type="array">
    <item>
     <name>项目</name>
    </item>
    <item>
     <name>指标分析</name>
    </item>
    <item>
     <name>指标</name>
    </item>
   </header>
   <mergeRows type="array">
    <item>
     <col>0</col>
    </item>
   </mergeRows>
   <mergeTitle>true</mergeTitle>
   <data>${fmtServ.result}</data>
  </response>
 </controller>
 <controller id="dbxqExport">
  <context key="cal" value="${request.date.asCalendar}"/>
  <context key="compId" value="${orgs.BMDBOrganization.ids[request.item.asInt]}"/>
  <callservice id="servDbxq"/>
  <callcontroller id="servFmtterDbxq" inline="true"/>
  <ExcelTemplate id="excelTemplate" sheet="对标需求"/>
  <list id="title" type="string">项目,指标分析,指标</list>
  <formatter id="excel">
   <ExcelTitleFilter>
    <ExcelTemplate ref="excelTemplate"/>
    <Offset row="0" col="0"/>
    <titles>
     <title ref="title"/>
    </titles>
   </ExcelTitleFilter>
   <ExcelMergeFormatter>
    <ExcelTemplate ref="excelTemplate"/>
    <MergeRegion x="0" y="1" width="1" height="${result.ids.size}"/>
   </ExcelMergeFormatter>
   <ExcelHeaderCenterFormatter>
    <DefaultMatcher cols="0,1"/>
    <ExcelTemplate ref="excelTemplate"/>
    <Offset row="1" col="0"/>
   </ExcelHeaderCenterFormatter>
   <ExcelOffsetFormatter>
    <ExcelTemplate ref="excelTemplate"/>
    <Offset row="1" col="0"/>
   </ExcelOffsetFormatter>
  </formatter>
  <formatterServer id="fmtServ" table="${result.matrixNoIds}">
   <formatter ref="fmtData"/>
   <formatter ref="excel"/>
  </formatterServer>
  <response type="excel" ref="excelTemplate" name="${request.date.asString}对标需求.xls" serv="fmtServ"/>
 </controller>
 <controller id="dbxq">
  <response type="jsp" name="framework/templates/dateReport/show">
   <map key="year" value="${calendar.current.year}"/>
   <map key="month" value="${calendar.current.month}"/>
   <map key="updateUrl" value="dbxqUpdate"/>
   <map key="exportUrl" value="dbxqExport"/>
   <map map="${authMgr[23]}"/>
   <map key="title" value="对标需求"/>
  </response>
 </controller>
</components>
